# Refinement-based game semantics (fork)

This fork of `CertiKOS/rbgs` adds a concurrency signature/monad scaffold (`models/Conc*`, `examples/Conc*`) and a white paper explaining the direction. The base repo builds against modern Coq while keeping CompCert optional.

## Quick start

### Toolchain

Use the CompCert-compatible toolchain (no Rosetta on macOS):

```
opam switch create rbgs-ocaml-4.12 4.12.1
opam install coq.8.15.2 menhir.20200211
eval "$(opam env --switch=rbgs-ocaml-4.12)"
```

### Configure and build

Clone your fork and build:

```
git clone https://github.com/<your-username>/rbgs.git
cd rbgs
./configure -nocompcert   # macOS-friendly; use ./configure on Linux to include CompCert
make -j4
```

Notes:
- CompCert’s runtime currently expects GNU binutils; on macOS use `-nocompcert` or build on Linux.
- The `_CoqProject` already lists the new concurrency files.

## What’s in this fork

- Concurrency scaffolding: `models/ConcSignature.v`, `ConcMonad.v`, `ConcStrategy.v`, `ConcRefinement.v`, plus driving stubs `examples/ConcSpawn.v`, `examples/ConcChan.v`.
- White paper: `White_paper/whitepaper.md` summarizes goals, current status, and next steps.
- Bibliography: `references.bib` cites the three guiding papers (`compcertoe`, `compcertoc`, `ctlinear-jacm`).
- Smart constructors and notations: `ConcMonad.spawn/yield/send/recv/join` build effectful terms directly from the signature, and `ConcMonad.Notations` offers a `do`-notation (`x <- t ;; u`) for lighter scripts.
- Proof scaffolding: `ConcRefinement.returns` interprets a concurrent term in a total-correctness style (every branch returns the same configuration), with lemmas for spawn/yield/send/recv/join and tensor pairing.

Refinement notes:
- `ConcRefinement.v` now encodes a total-correctness predicate (`returns`) that forces every branch of a concurrent term to converge to the same configuration. Strengthening this to trace/scheduler simulations is the next milestone.
- Example stubs compile and are ready to be expanded into full refinement case studies.

## Running without CompCert

If you only need the Rocq developments, configure with `./configure -nocompcert` and run `make -j4`. CompCert can be re-enabled later by re-running `./configure` (on Linux) and `make clean && make -jN`.
